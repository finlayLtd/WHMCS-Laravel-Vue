import{_ as O,f as r,b as H,d as g,r as q,o as a,c as n,h as e,t as l,a as v,i as S,m as z,l as E,F as h,s as A,x as G,j as b,y as U}from"./app-4c139354.js";import{S as J}from"./services-aae0370f.js";import{c as K}from"./commonApis-405e0354.js";import{P as Q}from"./Pagination-be932247.js";import{L as W}from"./index-71683c7d.js";import{N as X}from"./NoPermission-94ce4803.js";const Y={class:"dashboard"},Z={class:"container"},x={class:"d-flex justify-content-between align-items-center title-button-wrapper position-relative"},tt={class:"title mb-0"},et={type:"submit",class:"btn btn-dark btn-chevron chevron-dark hover-dark-light options-toggle dropdown-toggle","data-bs-toggle":"dropdown"},st={class:"options-toggle-dropdown create-server dropdown-menu dropdown-menu-end"},lt={key:0,class:"sub-section server-list-tab vl-parent"},ot={class:"row justify-content-between align-items-center"},at={class:"col-md-12"},nt={class:"w-100 mb-2 mb-lg-5"},it={class:"sub-title"},rt={class:"topTicketBar"},dt={class:"sort-servers order-2 order-md-1"},ct={key:0,class:"sorting-items"},ut={class:"nav nav-pills mb-3 mb-md-0 order-1 order-md-2 mb-lg-0 topFilterBox",id:"pills-tab",role:"tablist"},pt={class:"nav-item",role:"presentation"},vt=["id","data-bs-target","aria-controls","onClick"],_t={class:"w-100 support-table mb-4"},mt={class:"table"},gt={scope:"col"},ht={scope:"col"},bt={scope:"col"},ft={scope:"col"},kt={scope:"col"},yt={key:0},$t={colspan:"5",style:{"text-align":"center"}},Ct={style:{"margin-top":"20px"}},wt=["innerHTML"],Tt={class:"refund-request"},Pt={class:"date-cell"},St={class:"w-100 server-list-pagination"},f=5,At={__name:"dashboard",setup(Lt){const u=r(!1),L=K(),_=r(!1),B=H(),k=g(()=>B.state.auth.user),p=r([]),$=r([]),N=r(0),d=r("All"),D=r(["All","Open","Answered","Customer-Reply","Closed"]),c=r({client_id:k.value.client_id,orderby:"",order:"",page:1}),C=()=>{u.value=!0,L.runGetApi("/support-ticket",c.value).then(t=>{u.value=!1,_.value=!1,p.value=t.data.tickets;const o=g(()=>{var s,y;return(y=(s=t==null?void 0:t.data)==null?void 0:s.status)==null?void 0:y.filter(M=>D.value.includes(M.title))});$.value=o.value;const i=t.data.totalTickets;N.value=Math.ceil(i/f)}).catch(t=>{console.log(t),u.value=!1})};C();function I(t){c.value.page=t}function w(t){return`pills-${T(t)}`}function R(t){return`pills-${T(t)}-tab`}function T(t){return t.toLowerCase().replace(/ /g,"-")}const V=t=>t.replace(/\n/g,"<br>");function m(t,o){c.value.orderby=t,c.value.order=o,C()}function j(t){return t=="Answered"?"successful-cell":t=="Closed"?"cancelled-cell":"in-progress-cell"}const P=r([]),F=g(()=>{let t;d.value==="All"?t=p.value:t=p.value.filter(i=>i.status===d.value);const o=g(()=>{const i=(c.value.page-1)*f,s=i+f;return t.slice(i,s)});return P.value[d.value]=Math.ceil(t.length/f),o.value});return(t,o)=>{const i=q("router-link");return a(),n("section",Y,[e("div",Z,[e("div",x,[e("h2",tt,l(t.$t("Dashboard")),1),e("button",et,l(t.$t("Create_server")),1),e("div",st,[e("ul",null,[e("li",null,[v(i,{to:"/create-vps-server"},{default:S(()=>[b(l(t.$t("Create_VPS_Server")),1)]),_:1})])])])]),k.value&&k.value.permissions.split(",").includes("tickets")?(a(),n("div",lt,[v(z(W),{active:u.value,"onUpdate:active":o[0]||(o[0]=s=>u.value=s),"is-full-page":!1},null,8,["active"]),e("div",ot,[e("div",at,[e("div",nt,[e("h3",it,l(t.$t("Support_Tickets")),1),e("div",rt,[e("div",dt,[e("div",{id:"toggleButton",class:"sort-item-active btn-chevron chevron-dark topSortBox",style:{width:"160px"},onClick:o[1]||(o[1]=s=>_.value=!_.value)},[e("span",null,l(t.$t("Sort_by"))+"...",1)]),_.value?(a(),n("div",ct,[e("ul",null,[e("li",{class:"touch-item",onClick:o[2]||(o[2]=s=>m("date","desc"))},l(t.$t("Opened_latest")),1),e("li",{class:"touch-item",onClick:o[3]||(o[3]=s=>m("date","asc"))},l(t.$t("Opened_oldest")),1),e("li",{class:"touch-item",onClick:o[4]||(o[4]=s=>m("lastreply","desc"))},l(t.$t("Last_Reply_latest")),1),e("li",{class:"touch-item",onClick:o[5]||(o[5]=s=>m("date","asc"))},l(t.$t("Last_Reply_oldest")),1)])])):E("",!0)]),e("ul",ut,[e("li",pt,[e("button",{class:"nav-link active",id:"pills-all-tab","data-bs-toggle":"pill","data-bs-target":"#pills-all",type:"button",role:"tab","aria-controls":"pills-all","aria-selected":"true",onClick:o[6]||(o[6]=s=>d.value="All")},l(t.$t("All")),1)]),(a(!0),n(h,null,A($.value,s=>(a(),n("li",{key:s.title,class:"nav-item",role:"presentation"},[e("button",{id:R(s.title),class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#"+w(s.title),type:"button",role:"tab","aria-controls":w(s.title),"aria-selected":!1,onClick:y=>d.value=s.title},[s.title=="Customer-Reply"?(a(),n(h,{key:0},[b(l(t.$t("Customer_Reply")),1)],64)):(a(),n(h,{key:1},[b(l(t.$t(s.title)),1)],64))],8,vt)]))),128))])])]),e("div",_t,[e("table",mt,[e("thead",null,[e("tr",null,[e("th",gt,l(t.$t("Ticket_No")),1),e("th",ht,l(t.$t("Title")),1),e("th",bt,l(t.$t("Priority")),1),e("th",ft,l(t.$t("Date_title")),1),e("th",kt,l(t.$t("Status")),1)])]),e("tbody",null,[!p.value||p.value.length===0?(a(),n("tr",yt,[e("td",$t,[e("h5",Ct,l(t.$t("No_tickets")),1)])])):(a(!0),n(h,{key:1},A(F.value,s=>(a(),n("tr",{key:s.id},[e("td",null,[v(i,{to:{name:"ticket-detail",params:{id:s.id}}},{default:S(()=>[b(" #"+l(s.tid),1)]),_:2},1032,["to"])]),e("td",{innerHTML:V(s.subject)},null,8,wt),e("td",Tt,l(t.$t(s.priority)),1),e("td",Pt,l(s.date),1),e("td",{class:U(j(s.status))},[e("span",null,l(t.$t(s.status)),1)],2)]))),128))])])]),e("div",St,[v(Q,{currentPage:c.value.page,totalPages:P.value[d.value],onPageChanged:I},null,8,["currentPage","totalPages"])])])])])):(a(),G(X,{key:1})),v(J)])])}}},jt=O(At,[["__scopeId","data-v-326034aa"]]);export{jt as default};
