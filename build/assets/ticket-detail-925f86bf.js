import{D as C,u as D,c as T,k as u,r as A,b as a,d as o,e,h as F,l as V,t as n,f as $,F as N,A as S,m as d,w as B,z as R,g as q}from"./app-c4a345d8.js";import{c as E,s as l}from"./loading-8c6d7625.js";import{d as I}from"./theme-sugar-eadf48c4.js";const L={class:"dashboard"},P={class:"container"},j={class:"title-button-wrapper ticket-detail"},z=e("img",{class:"status-arrow",src:"/assets/img/status-arrow.svg",alt:""},null,-1),M={class:"ticket-status-title color-in-work"},O={class:"title mb-0 mt-2"},U={class:"sub-section server-list-tab"},G={class:"row justify-content-between align-items-center"},H={class:"row mb-5 pe-0"},J={class:"col-12"},K={class:"card-item p-4 mb-4 support-item flex-column"},Q={key:0,class:"message-item-wrapper"},W={key:0,class:"message-item message-received"},X={class:"message-item-header"},Y={class:"message-sender"},Z={class:"fs-15"},ee={class:"message-sent-time fs-13"},se={class:"message-content-wrapper"},te={key:0,class:"message-body"},ae={key:1,class:"message-body message-attachment-body",style:{width:"fit-content"}},oe=["onClick","data-lightbox"],ie=e("img",{src:"/assets/img/download_icon.png",style:{width:"24px"},alt:""},null,-1),ne={class:"text-decoration-underline"},le={key:1,class:"message-item message-sent"},de={class:"message-item-header"},ce={class:"message-sender"},re={class:"fs-15"},_e={class:"message-sent-time fs-13"},me={class:"message-content-wrapper"},ue={key:0,class:"message-body"},he={key:1,class:"message-body message-attachment-body",style:{width:"fit-content","margin-left":"auto"}},pe=["onClick","data-lightbox"],ge=e("img",{src:"/assets/img/download_icon.png",style:{width:"24px"},alt:""},null,-1),ve={class:"text-decoration-underline"},fe={class:"message-send-area-wrapper mt-4"},ke={class:"upload-attachment"},we=e("label",{class:"file-label",for:"file"},null,-1),be=["value"],ye={class:"message-box"},xe={key:0},Ce={key:0,id:"file-name",style:{"overflow-wrap":"anywhere"}},De=e("span",{id:"file-name",style:{"overflow-wrap":"anywhere"}},null,-1),Te={class:"mt-1",style:{"text-align":"right"}},Ae=["disabled"],Se={__name:"ticket-detail",setup(Fe){const p=C();I.useToast();const g=E(),f=D(),k=T(()=>f.state.auth.user),c=u({}),_=u(""),r=u(null),h=u("");u({client_id:k.value.client_id,orderby:"",order:""});const w=()=>{l(!0),g.runPostApi("/get-ticketDetails",{id:p.params.id}).then(t=>{l(!1),c.value=t.data.ticket_detail}).catch(t=>{l(!1),console.log(t)})},b=t=>{r.value=t.target.files[0],h.value=t.target.files[0].name,console.log(h.value)},v=t=>{l(!0),g.runPostApi("/download-file",{id:t}).then(i=>{l(!1),i.data.result=="success"&&window.open(i.data.redirect_url,"_blank")}).catch(i=>{l(!1),console.log(i)})},y=()=>{l(!0);const t=new FormData;r.value!=null&&t.append("file",r.value),t.append("ticket_id",p.params.id),t.append("message",_.value);const i={"Content-Type":"multipart/form-data"};axios.post("/api/sendReply",t,{headers:i}).then(m=>{l(!1),c.value=m.data.ticket_detail,_.value="",r.value=null}).catch(m=>{l(!1),console.log(m)})};return w(),(t,i)=>{const m=A("router-link");return a(),o("section",L,[e("div",P,[e("div",j,[F(m,{to:"/support-ticket"},{default:V(()=>[z]),_:1}),e("h3",M,n(c.value.status),1),e("h2",O,"Ticket#"+n($(p).params.id),1)]),e("div",U,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[c.value.replies?(a(),o("div",Q,[(a(!0),o(N,null,S(c.value.replies.reply,s=>(a(),o("div",{key:s.replyid,style:{"margin-bottom":"20px"}},[s.requestor_type=="Owner"?(a(),o("div",W,[e("div",X,[e("div",Y,[e("span",Z,n(s.requestor_name),1),e("span",ee,n(s.date),1)])]),e("div",se,[s.message&&s.message!=" "?(a(),o("div",te,[e("div",null,n(s.message),1)])):d("",!0),s.attachment?(a(),o("div",ae,[e("a",{class:"blackColor",onClick:x=>v(s.replyid),"data-lightbox":"image-r"+s.replyid,style:{cursor:"pointer"}},[ie,e("span",ne,n(s.attachment),1)],8,oe)])):d("",!0)])])):(a(),o("div",le,[e("div",de,[e("div",ce,[e("span",re,n(t.$reply.name),1),e("span",_e,n(t.$reply.date),1)])]),e("div",me,[s.message&&s.message!=" "?(a(),o("div",ue,[e("div",null,n(s.message),1)])):d("",!0),s.attachment?(a(),o("div",he,[e("div",null,[e("a",{class:"blackColor",onClick:x=>v(s.replyid),"data-lightbox":"image-r"+s.replyid,style:{cursor:"pointer"}},[ge,e("span",ve,n(s.attachment),1)],8,pe)])])):d("",!0)])]))]))),128))])):d("",!0),e("div",fe,[e("div",ke,[we,e("input",{name:"file",type:"file",style:{display:"none"},id:"file",onChange:b,ref:"fileInput"},null,544),e("input",{name:"ticket_id",type:"hidden",id:"ticket_id",value:c.value.id},null,8,be)]),e("div",ye,[B(e("textarea",{id:"message",name:"message",class:"p-3",cols:"30",rows:"5",placeholder:"Type messages..","onUpdate:modelValue":i[0]||(i[0]=s=>_.value=s)},null,512),[[R,_.value]]),r.value?(a(),o("div",xe,[q(" File Selected: "),h.value!=""?(a(),o("span",Ce,n(h.value),1)):d("",!0),De])):d("",!0)])]),e("div",Te,[e("button",{class:"btn-dark change-profile-btn fs-15",style:{"margin-right":"0px"},onClick:i[1]||(i[1]=s=>y()),disabled:_.value==""&&r.value==null}," Send ",8,Ae)])])])])])])])])}}};export{Se as default};
