import{_ as O,f as n,b as R,d as h,e as H,r as U,o as i,c as r,h as t,t as o,a as v,i as T,m as q,l as z,F as P,s as S,x as E,j as A,y as G}from"./app-d3a86fd1.js";import{L as x,S as J}from"./services-2196cb08.js";import{c as K}from"./commonApis-e31faf1f.js";import{P as Q}from"./Pagination-69045833.js";import{N as W}from"./NoPermission-2b0d56bb.js";const X={class:"dashboard"},Y={class:"container"},Z={class:"d-flex justify-content-between align-items-center title-button-wrapper position-relative"},tt={class:"title mb-0"},et={type:"submit",class:"btn btn-dark btn-chevron chevron-dark hover-dark-light options-toggle dropdown-toggle","data-bs-toggle":"dropdown"},st={class:"options-toggle-dropdown create-server dropdown-menu dropdown-menu-end"},lt={key:0,class:"sub-section server-list-tab vl-parent"},ot={class:"row justify-content-between align-items-center"},at={class:"col-md-12"},nt={class:"w-100 mb-2 mb-lg-5"},it={class:"sub-title"},rt={class:"topTicketBar"},dt={class:"sort-servers order-2 order-md-1"},ct={key:0,class:"sorting-items"},ut={class:"nav nav-pills mb-3 mb-md-0 order-1 order-md-2 mb-lg-0 topFilterBox",id:"pills-tab",role:"tablist"},pt={class:"nav-item",role:"presentation"},vt=["id","data-bs-target","aria-controls","onClick"],_t={class:"w-100 support-table mb-4"},gt={class:"table"},ht={scope:"col"},mt={scope:"col"},bt={scope:"col"},ft={scope:"col"},kt={scope:"col"},yt={key:0},$t={colspan:"5",style:{"text-align":"center"}},Ct={style:{"margin-top":"20px"}},wt=["innerHTML"],Tt={class:"refund-request"},Pt={class:"date-cell"},St={class:"w-100 server-list-pagination"},m=5,At={__name:"dashboard",setup(Lt){const u=n(!1),L=K(),_=n(!1),B=R(),b=h(()=>B.state.auth.user),p=n([]),k=n([]),N=n(0),d=n("All"),D=n(["All","Open","Answered","Customer-Reply","Closed"]),c=n({client_id:b.value.client_id,orderby:"",order:"",page:1}),y=()=>{u.value=!0,L.runGetApi("/support-ticket",c.value).then(e=>{u.value=!1,_.value=!1,p.value=e.data.tickets;const l=h(()=>{var s,f;return(f=(s=e==null?void 0:e.data)==null?void 0:s.status)==null?void 0:f.filter(M=>D.value.includes(M.title))});k.value=l.value;const a=e.data.totalTickets;N.value=Math.ceil(a/m)}).catch(e=>{console.log(e),u.value=!1})};y();function I(e){c.value.page=e}function $(e){return`pills-${C(e)}`}function V(e){return`pills-${C(e)}-tab`}function C(e){return e.toLowerCase().replace(/ /g,"-")}function g(e,l){c.value.orderby=e,c.value.order=l,y()}function j(e){return e=="Answered"?"successful-cell":e=="Closed"?"cancelled-cell":"in-progress-cell"}const w=n([]),F=h(()=>{let e;d.value==="All"?e=p.value:e=p.value.filter(a=>a.status===d.value);const l=h(()=>{const a=(c.value.page-1)*m,s=a+m;return e.slice(a,s)});return w.value[d.value]=Math.ceil(e.length/m),l.value});return H().getUser(),(e,l)=>{const a=U("router-link");return i(),r("section",X,[t("div",Y,[t("div",Z,[t("h2",tt,o(e.$t("Dashboard")),1),t("button",et,o(e.$t("Create_server")),1),t("div",st,[t("ul",null,[t("li",null,[v(a,{to:"/create-vps-server"},{default:T(()=>[A(o(e.$t("Create_VPS_Server")),1)]),_:1})])])])]),b.value&&b.value.permissions.split(",").includes("tickets")?(i(),r("div",lt,[v(q(x),{active:u.value,"onUpdate:active":l[0]||(l[0]=s=>u.value=s),"is-full-page":!1},null,8,["active"]),t("div",ot,[t("div",at,[t("div",nt,[t("h3",it,o(e.$t("Support_Tickets")),1),t("div",rt,[t("div",dt,[t("div",{id:"toggleButton",class:"sort-item-active btn-chevron chevron-dark topSortBox",style:{width:"160px"},onClick:l[1]||(l[1]=s=>_.value=!_.value)},[t("span",null,o(e.$t("Sort_by"))+"...",1)]),_.value?(i(),r("div",ct,[t("ul",null,[t("li",{class:"touch-item",onClick:l[2]||(l[2]=s=>g("date","desc"))},o(e.$t("Opened_latest")),1),t("li",{class:"touch-item",onClick:l[3]||(l[3]=s=>g("date","asc"))},o(e.$t("Opened_oldest")),1),t("li",{class:"touch-item",onClick:l[4]||(l[4]=s=>g("lastreply","desc"))},o(e.$t("Last_Reply_latest")),1),t("li",{class:"touch-item",onClick:l[5]||(l[5]=s=>g("date","asc"))},o(e.$t("Last_Reply_oldest")),1)])])):z("",!0)]),t("ul",ut,[t("li",pt,[t("button",{class:"nav-link active",id:"pills-all-tab","data-bs-toggle":"pill","data-bs-target":"#pills-all",type:"button",role:"tab","aria-controls":"pills-all","aria-selected":"true",onClick:l[6]||(l[6]=s=>d.value="All")}," All ")]),(i(!0),r(P,null,S(k.value,s=>(i(),r("li",{key:s.title,class:"nav-item",role:"presentation"},[t("button",{id:V(s.title),class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#"+$(s.title),type:"button",role:"tab","aria-controls":$(s.title),"aria-selected":!1,onClick:f=>d.value=s.title},o(s.title),9,vt)]))),128))])])]),t("div",_t,[t("table",gt,[t("thead",null,[t("tr",null,[t("th",ht,o(e.$t("Ticket_No")),1),t("th",mt,o(e.$t("Title")),1),t("th",bt,o(e.$t("Priority")),1),t("th",ft,o(e.$t("Date_title")),1),t("th",kt,o(e.$t("Status")),1)])]),t("tbody",null,[!p.value||p.value.length===0?(i(),r("tr",yt,[t("td",$t,[t("h5",Ct,o(e.$t("No_tickets")),1)])])):(i(!0),r(P,{key:1},S(F.value,s=>(i(),r("tr",{key:s.id},[t("td",null,[v(a,{to:{name:"ticket-detail",params:{id:s.id}}},{default:T(()=>[A(" #"+o(s.tid),1)]),_:2},1032,["to"])]),t("td",{innerHTML:s.subject},null,8,wt),t("td",Tt,o(s.priority),1),t("td",Pt,o(s.date),1),t("td",{class:G(j(s.status))},[t("span",null,o(s.status),1)],2)]))),128))])])]),t("div",St,[v(Q,{currentPage:c.value.page,totalPages:w.value[d.value],onPageChanged:I},null,8,["currentPage","totalPages"])])])])])):(i(),E(W,{key:1})),v(J)])])}}},jt=O(At,[["__scopeId","data-v-660d9862"]]);export{jt as default};
