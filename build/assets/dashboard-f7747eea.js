import{_ as O,f as r,b as H,d as m,e as U,r as q,o as a,c as n,h as e,t as l,a as v,i as S,m as z,l as E,F as b,s as A,x as G,j as h,y as J}from"./app-9de27a2b.js";import{L as K,S as Q}from"./services-101e08da.js";import{c as W}from"./commonApis-d413e87c.js";import{P as X}from"./Pagination-06f29d44.js";import{N as Y}from"./NoPermission-3b2ff471.js";const Z={class:"dashboard"},x={class:"container"},tt={class:"d-flex justify-content-between align-items-center title-button-wrapper position-relative"},et={class:"title mb-0"},st={type:"submit",class:"btn btn-dark btn-chevron chevron-dark hover-dark-light options-toggle dropdown-toggle","data-bs-toggle":"dropdown"},lt={class:"options-toggle-dropdown create-server dropdown-menu dropdown-menu-end"},ot={key:0,class:"sub-section server-list-tab vl-parent"},at={class:"row justify-content-between align-items-center"},nt={class:"col-md-12"},it={class:"w-100 mb-2 mb-lg-5"},rt={class:"sub-title"},dt={class:"topTicketBar"},ct={class:"sort-servers order-2 order-md-1"},ut={key:0,class:"sorting-items"},pt={class:"nav nav-pills mb-3 mb-md-0 order-1 order-md-2 mb-lg-0 topFilterBox",id:"pills-tab",role:"tablist"},vt={class:"nav-item",role:"presentation"},_t=["id","data-bs-target","aria-controls","onClick"],gt={class:"w-100 support-table mb-4"},mt={class:"table"},bt={scope:"col"},ht={scope:"col"},ft={scope:"col"},kt={scope:"col"},yt={scope:"col"},$t={key:0},Ct={colspan:"5",style:{"text-align":"center"}},wt={style:{"margin-top":"20px"}},Tt=["innerHTML"],Pt={class:"refund-request"},St={class:"date-cell"},At={class:"w-100 server-list-pagination"},f=5,Lt={__name:"dashboard",setup(Bt){const u=r(!1),L=W(),_=r(!1),B=H(),k=m(()=>B.state.auth.user),p=r([]),$=r([]),N=r(0),d=r("All"),D=r(["All","Open","Answered","Customer-Reply","Closed"]),c=r({client_id:k.value.client_id,orderby:"",order:"",page:1}),C=()=>{u.value=!0,L.runGetApi("/support-ticket",c.value).then(t=>{u.value=!1,_.value=!1,p.value=t.data.tickets;const o=m(()=>{var s,y;return(y=(s=t==null?void 0:t.data)==null?void 0:s.status)==null?void 0:y.filter(M=>D.value.includes(M.title))});$.value=o.value;const i=t.data.totalTickets;N.value=Math.ceil(i/f)}).catch(t=>{console.log(t),u.value=!1})};C();function I(t){c.value.page=t}function w(t){return`pills-${T(t)}`}function R(t){return`pills-${T(t)}-tab`}function T(t){return t.toLowerCase().replace(/ /g,"-")}const V=t=>t.replace(/\n/g,"<br>");function g(t,o){c.value.orderby=t,c.value.order=o,C()}function j(t){return t=="Answered"?"successful-cell":t=="Closed"?"cancelled-cell":"in-progress-cell"}const P=r([]),F=m(()=>{let t;d.value==="All"?t=p.value:t=p.value.filter(i=>i.status===d.value);const o=m(()=>{const i=(c.value.page-1)*f,s=i+f;return t.slice(i,s)});return P.value[d.value]=Math.ceil(t.length/f),o.value});return U().getUser(),(t,o)=>{const i=q("router-link");return a(),n("section",Z,[e("div",x,[e("div",tt,[e("h2",et,l(t.$t("Dashboard")),1),e("button",st,l(t.$t("Create_server")),1),e("div",lt,[e("ul",null,[e("li",null,[v(i,{to:"/create-vps-server"},{default:S(()=>[h(l(t.$t("Create_VPS_Server")),1)]),_:1})])])])]),k.value&&k.value.permissions.split(",").includes("tickets")?(a(),n("div",ot,[v(z(K),{active:u.value,"onUpdate:active":o[0]||(o[0]=s=>u.value=s),"is-full-page":!1},null,8,["active"]),e("div",at,[e("div",nt,[e("div",it,[e("h3",rt,l(t.$t("Support_Tickets")),1),e("div",dt,[e("div",ct,[e("div",{id:"toggleButton",class:"sort-item-active btn-chevron chevron-dark topSortBox",style:{width:"160px"},onClick:o[1]||(o[1]=s=>_.value=!_.value)},[e("span",null,l(t.$t("Sort_by"))+"...",1)]),_.value?(a(),n("div",ut,[e("ul",null,[e("li",{class:"touch-item",onClick:o[2]||(o[2]=s=>g("date","desc"))},l(t.$t("Opened_latest")),1),e("li",{class:"touch-item",onClick:o[3]||(o[3]=s=>g("date","asc"))},l(t.$t("Opened_oldest")),1),e("li",{class:"touch-item",onClick:o[4]||(o[4]=s=>g("lastreply","desc"))},l(t.$t("Last_Reply_latest")),1),e("li",{class:"touch-item",onClick:o[5]||(o[5]=s=>g("date","asc"))},l(t.$t("Last_Reply_oldest")),1)])])):E("",!0)]),e("ul",pt,[e("li",vt,[e("button",{class:"nav-link active",id:"pills-all-tab","data-bs-toggle":"pill","data-bs-target":"#pills-all",type:"button",role:"tab","aria-controls":"pills-all","aria-selected":"true",onClick:o[6]||(o[6]=s=>d.value="All")},l(t.$t("All")),1)]),(a(!0),n(b,null,A($.value,s=>(a(),n("li",{key:s.title,class:"nav-item",role:"presentation"},[e("button",{id:R(s.title),class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#"+w(s.title),type:"button",role:"tab","aria-controls":w(s.title),"aria-selected":!1,onClick:y=>d.value=s.title},[s.title=="Customer-Reply"?(a(),n(b,{key:0},[h(l(t.$t("Customer_Reply")),1)],64)):(a(),n(b,{key:1},[h(l(t.$t(s.title)),1)],64))],8,_t)]))),128))])])]),e("div",gt,[e("table",mt,[e("thead",null,[e("tr",null,[e("th",bt,l(t.$t("Ticket_No")),1),e("th",ht,l(t.$t("Title")),1),e("th",ft,l(t.$t("Priority")),1),e("th",kt,l(t.$t("Date_title")),1),e("th",yt,l(t.$t("Status")),1)])]),e("tbody",null,[!p.value||p.value.length===0?(a(),n("tr",$t,[e("td",Ct,[e("h5",wt,l(t.$t("No_tickets")),1)])])):(a(!0),n(b,{key:1},A(F.value,s=>(a(),n("tr",{key:s.id},[e("td",null,[v(i,{to:{name:"ticket-detail",params:{id:s.id}}},{default:S(()=>[h(" #"+l(s.tid),1)]),_:2},1032,["to"])]),e("td",{innerHTML:V(s.subject)},null,8,Tt),e("td",Pt,l(t.$t(s.priority)),1),e("td",St,l(s.date),1),e("td",{class:J(j(s.status))},[e("span",null,l(t.$t(s.status)),1)],2)]))),128))])])]),e("div",At,[v(X,{currentPage:c.value.page,totalPages:P.value[d.value],onPageChanged:I},null,8,["currentPage","totalPages"])])])])])):(a(),G(Y,{key:1})),v(Q)])])}}},jt=O(Lt,[["__scopeId","data-v-8cf0eba3"]]);export{jt as default};
